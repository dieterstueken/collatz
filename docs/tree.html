<!DOCTYPE html>
<html lang="de">
 <head>
  <meta charset="utf-8"/>
  <title>on the collaz problem</title>

  <script src="collatz.js"></script>
  <script type="text/javascript">

    function StepTable(table) {

        var tree = new Tree();

        this.show = function(len, filter) {
            while(table.rows.length)
                table.deleteRow(-1);

            len = Number(len);
            if(filter)
                filter = Number(filter);

            for(var n=0; n<len; ++n) {

                var node = tree.node(n);
    
                if(filter && filter>0 && filter!=node.len)
                    continue;

                var row = table.insertRow();
                row.align="right";

                var cell=row.insertCell()
                cell.className= node.succ.n>node.n?"rd":"gr";
                var span =  document.createElement("span");
                cell.appendChild(span);
                span.textContent=node.succ.n;
                span.title=node.succ.n.toString(2);

                var span =  document.createElement("span");
                cell=row.insertCell()
                cell.appendChild(span);
                span.textContent=node.n;
                span.title=node.n.toString(2);
                if((node.n%3)==0)
                        cell.className="bl";

                cell=row.insertCell()
                var span =  document.createElement("span");
                span.textContent=node.index;
                span.title=node.index.toString(2);
                cell.appendChild(span);

                cell=row.insertCell()
                cell.textContent=node.len;

                cell=row.insertCell()
                cell.textContent=node.fac();

                cell=row.insertCell()
                cell.textContent=node.max.n;

                cell=row.insertCell()
                cell.style.textAlign="left";

                let max = node.max.n;
                appendPath = function(node) {

                    // append successors first
                    let succ = node.succ;
                    if(succ!=node && succ.index>0)
                        appendPath(succ);

                    // append current successor
                    var span =  document.createElement("span");
                    span.textContent=" " + node.step;
                    span.title=succ.n + "<-" + node.n;
                    if(node.n == max)
                        span.className = "rd";

                    cell.appendChild(span);
                }

                appendPath(node);
            }
        }
    }

    window.onload = function () {
        var table = document.getElementById("steps");
        var steps = new StepTable(table);
        var rows = document.getElementById("rows");
        var filter = document.getElementById("filter");

        function show() {
            steps.show(rows.value, filter.value);
        }

        document.getElementById("show").onclick = show;

        show();
    };


  </script>

  <style type="text/css">
    td {text-align: right; padding-left: 0.2em;}
    .bl {color: blue; text-shadow:black 2px 2px 2px;}
    .gr {color: green;}
    .rd {color: red;}
  </style>

 </head>
 <body>
  <input id="show" type="button" value="show"/>
  max:<input size="10" id="rows" type="text" value="500"/>
  filter:<input size="4" id="filter" type="text" value=""/>
  <br/>
  <table border='1' rules='groups'>
   <colgroup span="3" align="right"></colgroup>
   <colgroup span="2" align="right"></colgroup>
   <colgroup align="right"></colgroup>
   <thead>
   <tr>
     <th align="right">succ</th> 
     <th align="right">n</th>
     <th align="right">k</th>
    <th align="right">l</th>
    <th align="right">p</th>
     <th align="right">max</th>
     <th colspan='0'>path</th>
    </tr>
   </thead>
   <tbody id="steps">
   </tbody>
  </table>
 </body>
</html>
